<!DOCTYPE html>
<html lang="%%lang%%">
<meta charset="utf-8"/>
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Pedro Sobota's Weblog">
  <meta name="keywords" content="Pedro Sobota's Weblog'">
  <meta name="author" content="Pedro Sobota">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedro Sobota</title>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-33675243-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-33675243-1');
</script>

<script>
MathJax = {
  loader: {load: ['[tex]/tagformat']},
  // startup: {
  //   pageReady: () => {
  //     return MathJax.startup.defaultPageReady();
  //   }
  // },
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']], 
    packages: {'[+]': ['tagformat']},
    // color: {
    //   padding: '5px'
    // }
    //tags: 'ams',
    // tagformat: {
    //   // number: (n) => n.toString(),
    //   tag:    (tag) => 
    //     //'((' + tag + '))',
    //     'Formula(' + tag + ')',
    //   // id:     (id) => 'mjx-eqn-' + id.replace(/\s/g, '_'),
    //   // url:    (id, base) => base + '#' + encodeURIComponent(id),
    // }
  }, 
  chtml: {
    scale: 1
  }
}
</script>

<script src='img/MathJax-3.1.2-custom/tex-mml-chtml.js'></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- <link href="https://fonts.googleapis.com/css2?family=Asap&display=swap" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css2?family=Gwendolyn&display=swap" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="img/style_header.css"/><link rel="stylesheet" type="text/css" href="img/style_body_article.css"/>


</head>

<body class="article">

<header>

  <h1 class="maintitle">Pedro Sobota</h1>

  <div id="toppic">
    <!-- <img src="img/Header.png" width="800" height="300" alt="Header image"/> -->
    <p>
      Software engineer. <a href="CV-PedroSobota.pdf" target="_blank" alt="CV">CV</a>
    </p>
    <p>
      <a href="https://www.linkedin.com/in/pedrooss/" target="_blank" alt="LinkedIn">LinkedIn</a> |
      <a href="https://www.x.com/pedro_sobota/" target="_blank" alt="x.com">x.com</a> |
      pedro@sobo.cx
    </p>
  </div>

<!-- 
  <div class="maintitle">Pedro Sobota</div> -->



</header>

<div class="content">

  <div class="framed mathtoc toc2">

<!-- Begin article "Property Provider" -->

<article>
    <h1>Property Provider</h1>
    
    <!-- <div class="blogtags"><span class="blogtag algo">Logic</span><span class="blogtag algo">C#</span></div> -->
  
    <div class="article_details"><p>03/2024</p><hr/></div>
  
    <details>
  
    <summary><blockquote class="special"><b>Abstract: </b>This article describes the development of a semantic tool for mapping and relating objects to properties. The user can rank objects based on their properties, discover new objects, and identify gaps in property sets. The tool is designed to be minimal, open-source, cross-platform, and flexible, allowing for various interpretations of property meanings. It could be useful in discussions involving many concepts, aiding in onboarding, identifying edge cases, qualifying concepts, and maintaining structure in documentation. The implementation is in C# 11 and released under the AGPL-3.0.</blockquote></summary>
  
    <p>In the last articles, I had written in the theme of Mathematical topics examined from a computational light, and I've taken them for revision. I don't think I'll put them up again, in revised form, any soon, but one of the topics discussed were combinations of properties of certain abstract structures, considered physical structures in programming and completely abstract structures in Mathematics: for example, sets, tuples, lists, and so on. Upon further consideration, this topic provoked an advancement where I actually mapped a complete small set of combinations of properties of collections, and in the process, I observed I could now objectively rank them according to said set of properties, and discover new objects.</p>

    <p>This means a relation is established relating objects to properties, and we implement scoring algorithms ordering the objects with respect to a single object and supply a 'distance' measure between any two objects. We now know the most similar and dissimilar objects with respect to an object. We can, given a set of objects related to properties, check for holes and define missing combinations of properties as new, previously unknown, objects.</p>
    
    <p>In the program presented in this article, these facets are implemented minimally in a convenient and self-contained form that contains concise and robust code, can be compiled easily using an open source compiler, run cross-platform, and carry no external dependencies, while providing functional usability. This is the beginning of a set of tools which progressively expand on the operations available while following the same minimal and canonical focus. More tools with specific applications in mind will also be implemented as needed, to give different forms to access the same functionality, or test applied concepts.</p>
    
    <p>In this approach, the <i>meaning</i> of properties themselves is left for interpretation; the tool is mostly concerned with semantics and knowledge mapping. Variations of property sets or the meaning of properties can be stipulated; each combination is a project. The tool might be useful in occasions where a sizeable number of concepts are in discourse, and, while the subject matter is open for interpretation, a semantic tool helps onboarding, finding edge cases, or qualifying concepts in a measured, controlled way; or keeping structure for documentation of complexity.</p>
    
    <p>The following technical display should give a more precise illustration.</p>
    
    <p>Given the following input file:</p>
    
    <pre>
    Collections, Multiset
    Collections, Tuple
    Collections, Struct
    Collections, ElementNamedTuple
    Collections, Set
    Collections, Track
    Collections, Array
    Collections, String
    Collections, Column
    
    Properties, NaturalOrdering
    Properties, ElementNaming
    Properties, Uniqueness
    Properties, Typing
    Properties, Naming
    
    // Multiset has no properties
    
    Collections.Tuple , Properties.NaturalOrdering
    Collections.Struct, Properties.ElementNaming
    Collections.Set   , Properties.Uniqueness
    Collections.Track , Properties.Typing
    Collections.String, Properties.Naming
    
    Collections.ElementNamedTuple, Properties.ElementNaming
    Collections.ElementNamedTuple, Properties.NaturalOrdering
    Collections.Array            , Properties.NaturalOrdering
    Collections.Array            , Properties.Typing
    Collections.Column           , Properties.Naming
    Collections.Column           , Properties.NaturalOrdering
    Collections.Column           , Properties.Typing
    </pre>
    
    <p>The following results could follow:</p>
    
    <pre>
    PropertyProvider v0.1
    
    PP> load D:\PropertyProviderConsoleSample.txt
    2 classes constructed
    14 class elements added
    2 relations defined
    24 relation elements defined
    
    PP> help
    exit, outfile, classes, relations, [className],
    [className] v [className]
    [className] v [className] (!|!!|?|??) [classElement]
    
    PP> classes
    Collections, Properties
    
    PP> relations
    (Collections, Properties), (Properties, Collections)
    
    PP> Collections
    Collections.Multiset, Collections.Tuple, Collections.Struct, Collections.ElementNamedTuple, Collections.Set, Collections.Track, Collections.Array, Collections.String, Collections.Column
    
    PP> Properties
    Properties.NaturalOrdering, Properties.ElementNaming, Properties.Uniqueness, Properties.Typing, Properties.Naming
    
    PP> Collections v Properties
    > 
    +---------------------------+-----------------+
    | (Collections, Properties) | 1/5             |
    +---------------------------+-----------------+
    | Multiset                  |                 |
    | Tuple                     |                 |
    | Struct                    | ElementNaming   |
    | ElementNamedTuple         | ElementNaming   |
    | Set                       |                 |
    | Track                     |                 |
    | Array                     |                 |
    | String                    |                 |
    | Column                    |                 |
    +---------------------------+-----------------+
                               < >
    
    > help
    b|break, c|clear, pp, pn, pf, pl, p[pageNumber]
    
    > pn
    +---------------------------+-----------------+
    | (Collections, Properties) | 2/5             |
    +---------------------------+-----------------+
    | Multiset                  |                 |
    | Tuple                     |                 |
    | Struct                    |                 |
    | ElementNamedTuple         |                 |
    | Set                       |                 |
    | Track                     |                 |
    | Array                     |                 |
    | String                    | Naming          |
    | Column                    | Naming          |
    +---------------------------+-----------------+
                               < >
    
    PP> Properties v Collections
    > 
    +---------------------------+-------------------+
    | (Properties, Collections) | 1/9               |
    +---------------------------+-------------------+
    | NaturalOrdering           | Array             |
    | ElementNaming             |                   |
    | Uniqueness                |                   |
    | Typing                    | Array             |
    | Naming                    |                   |
    +---------------------------+-------------------+
                               < >
    
    PP> Properties v Collections
    > pn
    +---------------------------+-------------------+
    | (Properties, Collections) | 2/9               |
    +---------------------------+-------------------+
    | NaturalOrdering           | Column            |
    | ElementNaming             |                   |
    | Uniqueness                |                   |
    | Typing                    | Column            |
    | Naming                    | Column            |
    +---------------------------+-------------------+
                               < >
    
    PP> Collections v Properties ! Set
    > s
    +---------------------------+-----------------+
    | (Collections, Properties) | 1/5             |
    +---------------------------+-----------------+
    | (5) Set                   | ElementNaming   |
    | (4) Multiset              | ElementNaming   |
    | (3) Tuple                 | ElementNaming   |
    | (3) Struct                |                 |
    | (3) Track                 | ElementNaming   |
    | (3) String                | ElementNaming   |
    | (2) ElementNamedTuple     |                 |
    | (2) Array                 | ElementNaming   |
    | (1) Column                | ElementNaming   |
    +---------------------------+-----------------+
                               < >
    
    > pn
    +---------------------------+-----------------+
    | (Collections, Properties) | 2/5             |
    +---------------------------+-----------------+
    | (5) Set                   | Naming          |
    | (4) Multiset              | Naming          |
    | (3) Tuple                 | Naming          |
    | (3) Struct                | Naming          |
    | (3) Track                 | Naming          |
    | (3) String                |                 |
    | (2) ElementNamedTuple     | Naming          |
    | (2) Array                 | Naming          |
    | (1) Column                |                 |
    +---------------------------+-----------------+
                               < >
    
    PP> Properties v Collections !! Uniqueness
    > s
    +---------------------------+-------------------+
    | (Properties, Collections) | 1/9               |
    +---------------------------+-------------------+
    | (9) Uniqueness            |                   |
    | (6) ElementNaming         |                   |
    | (6) Naming                |                   |
    | (5) Typing                | Array             |
    | (4) NaturalOrdering       | Array             |
    +---------------------------+-------------------+
                               < >
    
    PP> Properties v Collections ! Uniqueness
    > s
    +---------------------------+-------------------+
    | (Properties, Collections) | 1/9               |
    +---------------------------+-------------------+
    | (9) Uniqueness            | Array             |
    | (6) ElementNaming         | Array             |
    | (6) Naming                | Array             |
    | (5) Typing                |                   |
    | (4) NaturalOrdering       |                   |
    +---------------------------+-------------------+
                               < >
    
    PP> Collections v Properties ? Array
    > s
    +---------------------------+-----------------+
    | (Collections, Properties) | 1/5             |
    +---------------------------+-----------------+
    | (3) Struct                |                 |
    | (3) Set                   | ElementNaming   |
    | (3) String                | ElementNaming   |
    | (2) Multiset              | ElementNaming   |
    | (2) ElementNamedTuple     |                 |
    | (1) Tuple                 | ElementNaming   |
    | (1) Track                 | ElementNaming   |
    | (1) Column                | ElementNaming   |
    | (0) Array                 | ElementNaming   |
    +---------------------------+-----------------+
                               < >
                               
    > save
    %LOCALAPPDATA%\PropertyProvider\PropertyProviderOut.txt
    
    +---------------------------+-----------------+-----------------+-----------------+-----------------+-----------------+
    | (Collections, Properties) | 1/5             | 2/5             | 3/5             | 4/5             | 5/5             |
    +---------------------------+-----------------+-----------------+-----------------+-----------------+-----------------+
    | (3) Struct                |                 | Naming          |                 |                 | Uniqueness      | 
    | (3) Set                   | ElementNaming   | Naming          |                 |                 |                 | 
    | (3) String                | ElementNaming   |                 |                 |                 | Uniqueness      | 
    | (2) Multiset              | ElementNaming   | Naming          |                 |                 | Uniqueness      | 
    | (2) ElementNamedTuple     |                 | Naming          | NaturalOrdering |                 | Uniqueness      | 
    | (1) Tuple                 | ElementNaming   | Naming          | NaturalOrdering |                 | Uniqueness      | 
    | (1) Track                 | ElementNaming   | Naming          |                 | Typing          | Uniqueness      | 
    | (1) Column                | ElementNaming   |                 | NaturalOrdering | Typing          | Uniqueness      | 
    | (0) Array                 | ElementNaming   | Naming          | NaturalOrdering | Typing          | Uniqueness      | 
    +---------------------------+-----------------+-----------------+-----------------+-----------------+-----------------+
    </pre>
    
    <h3>Observations</h3>
    
    <ul>
        <li>A project can contain any number of classes and relations. The "Properties" classes is not hardcoded and is just a "default" class name for properties of objects. Any classes of objects could be related</li>
        <li>Tables are paged to allow a constant width for inspection. Full tables can be printed to files with <code>save</code></li>
        <li>Reverse relations are automatically created from any relation</li>
        <li>The <code>A v B ! C</code> syntax, where <code>A</code> is the "key" class and <code>B</code> is the "value" class, performs <i>similarity scoring</i> (non-unique) in the relation with respect to element <code>C</code> of the key class. The descending similarity score is shown in parenthesis on the key cell</li>
        <li><i>Dissimilarity scoring</i> is also available with the <code>?</code> operator</li>
        <li>The double operators <code>!!</code> and <code>??</code> for scoring shows <i>true or false values</i> (which we call "characteristics"), as opposed to <i>equal or distinct values</i> (for similarity or dissimilarity respectively), for each key class</li>
        <li>The project abstracts class element names as <i>Symbols</i>, which allows to:
            <ul>
                <li>Enforce uniqueness of Symbols on a class</li>
                <li>Implement integer encoding of Symbols, as 1) combination of elements on a Set is expressible as a sum, 2) powers-of-two sums are unique, and 3) classes are Sets. Thus, element combinations (or Objects) are encoded as unique integers in a way such that, from an integer, the combination (or Object) is recoverable.</li>
            </ul>
        </li>
    </ul>
    
    <h3>Implementation</h3>
    
    <p>The operations have been implemented in a command line program written in C# 11 and released under the AGPL-3.0.</p>
    
    <ul>
        <li><a href="https://www.github.com/pedroos/PropertyProviderConsole" title="GitHub" target="_blank">GitHub</a></li>
    </ul>
  
    </details>
  </article>
  
<!-- End article "Property Provider" -->
<!-- Begin article "An Exponentiation-based Float Hash" -->

<article>
    <h1>An exponentiation-based list hash</h1>
    
    <!-- <div class="blogtags"><span class="blogtag algo">Algorithms</span><span class="blogtag algo">Mathematics</span></div> -->
  
    <div class="article_details"><p>03/2019</p><hr/></div>
  
    <details>
  
    <summary><blockquote class="special"><b>Abstract: </b>This article presents a mathematical algorithm to represent a list of real numbers as a single number using an exponentiation-based accumulation. We discuss the limitations of traditional statistical reductions like mean and standard deviation, and propose a non-commutative operation, exponentiation, to address these issues. The article also addresses challenges such as magnitude manipulations, leading zeros, and negative inputs, and proposes solutions to maintain the integrity of the original data. The algorithm's execution falls in the category of linear algorithms in time, making it efficient for medium to large lists, while being constant in space.</blockquote></summary>

<p>In this post, I'll describe an algorithm to represent real number lists by a single number.</p>

<p>First, we'll note mean and standard deviation from statistics are reductions commonly used to indicate properties about data expressed as lists of numbers.</p>

<p>The mean statistic, as a property of such list of numbers, is opaque to a modification such that one value is increased in the list while another value is decreased by the same amount. When this modification is performed, the resulting value is not modified. For example, </p>

$$\displaylines{
mean [7.5, 2.98, 6.72, 0.89, 3.74, 2.87] = \\
mean [6.5, 3.98, 6.72, 0.89, 3.74, 2.87].
}$$

<p>Obviously, for the purpose at hand, this would be a serious downside. On this point, the standard deviation is an improvement. That statistic's value is different for the same change:</p>

$$\displaylines{
stddev [7.5, 2.98, 6.72, 0.89, 3.74, 2.87] = 2.5149, \\
stddev [6.5, 3.98, 6.72, 0.89, 3.74, 2.87] = 2.21737.
}$$

<p>The standard deviation, however, is susceptible to a value swap between two numbers: exchanging the position of one value with the position of another one has no effect on the number list's dispersion or its mean value, either.</p>

<p>As an example, considering </p>

$$\displaylines{
A=[7.5, 2.98, 6.72, 0.89, 3.74, 2.87],\\
B=[2.98, 7.5, 6.72, 0.89, 3.74, 2.87]
}$$

<p>(elements 1-2 swapped),</p>

$$\displaylines{
stddev(A) = stddev(B), \\
mean(A) = mean(B).
}$$

<p>The common characteristic of those two algorithms over the list of numbers is that they aggregate using mathematically commutative operations: the order of the numbers presented to the operation does not influence its result. We'll examine the possibility of applying a operation which is not commutative to the same problem.<br/>

<h3>Ordering</h3>

<p>One of the first mathematical operations to suggest itself is exponentiation.</p>

$$\displaylines{
2 ^ 3 \neq 3 ^ 2, \\
\left(2 ^ 3\right) ^ 4 \neq 2 ^ \left(3 ^ 4\right).
}$$

<p>(Note that </p>

$$\displaylines{
2^4=4^2,
}$$

<p>but these are the only pair of natural numbers which commute under exponentiation [<a href="#references">1</a>].)</p>

<p>Drawing this operation of consecutive exponentation with the symbol \(\bigwedge\), and each exponentiation with \(\wedge\), now, </p>

$$\displaylines{
\bigwedge [7.5, 2.98, 6.72, 0.89, 3.74, 2.87] = \\
7.5 \wedge 2.98 \wedge 6.72 \wedge 0.89 \wedge 3.34 \wedge 2.87 = \\
436.491
}$$

<p>and </p>

$$\displaylines{
\bigwedge [2.98, 7.5, 6.72, 0.89, 3.74, 2.87] = \\
4348.3,
}$$

<p>such that the ordering requirement is now satisfied.</p>

<h3>Sizing</h3>

<p>As the ordering problem is solved, another immediate problem arises, that the exponentiated numbers grow too fast. We examine the case of \([5,6,4.6]\), which has a magnitude (measured in multiples of 10) of \(10 ^{2654}\).</p>

<p>We'll reduce the magnitude of every number to \(1\), by extracting the decimal exponent and dividing the number by it.</p>

<p>Now, </p>

$$\displaylines{
\bigwedge [5, 6, 4006] = \\
\left(5 \times \frac{1}{10^1}\right) \wedge \left(6 \times \frac{1}{10^1}\right) \wedge \left(4006 \times \frac{1}{10^4}\right) = \\
0.5 \wedge 0.6 \wedge 0.4006 = \\
0.568431.
}$$

<p>Drawing "normalized" numbers as \(\overline{x}\), </p>

$$\displaylines{
\overline{5} \wedge \overline{6} \wedge \overline{4006} = 0.568431.
}$$

<p>The result, now, sits within a controlled range between \(0\) and \(1\).</p>

<h3>Corner cases</h3>

<p>Some corner cases present themselves. The normalization opens up the possibility of magnitude manipulations (since the magnitude is taken out of every number). Thus changes like:</p>

$$\displaylines{\bigwedge [50,.6,46,0.63,.0005,4300,52] = 0.596399\text{,}}$$

$$\displaylines{\bigwedge [50,6,4.6,6.3,5,4.3,5.2] = 0.596399}$$

<p>yield equal results.</p>

<p>However, those same changes also change the mean value in the list:</p>

$$\displaylines{
mean [5,6,4.6,6.3,5,4.3,5.2] = 5.2, \\
mean [50,6,4.6,6.3,5,4.3,5.2] = 11.6286, 
}$$

<p>We'll prepend the mean to the list; the mean will end up used as the first exponent.</p>

$$\displaylines{
\bigwedge [5,6,4.6,6.3,5,4.3,5.2] = \\
\overline{5} \wedge (\overline{6} \wedge (\overline{4.6} \wedge (\overline{6.3} \wedge (\overline{5} \wedge (\overline{4.3} \wedge (\overline{5.2} \wedge mean)))))) = \\
\overline{5} \wedge (\overline{6} \wedge (\overline{4.6} \wedge (\overline{6.3} \wedge (\overline{5} \wedge (\overline{4.3} \wedge (\overline{5.2} \wedge \overline{5.2})))))) = \\
0.595317 \\ \neq \\
\bigwedge [50,6,4.6,6.3,5,4.3,5.2] = \\
\overline{11.6286} \wedge (\overline{50} \wedge (\overline{6} \wedge (\overline{4.6} \wedge (\overline{6.3} \wedge (\overline{5} \wedge (\overline{4.3} \wedge (\overline{5.2}))))))) = \\
0.595047.
}$$

<p>Now, because the mean is normalized like any other value in the list, a global multiplication of the list by factors of 10 will produce the same results. This case, though, is not fixed, because the manipulation required (multiplying every number by orders of 10) is considered too harmful to the integrity of the original data.</p>

<p>Exponentiation as the chosen operation presents relevant properties.</p>

<p>First, any base of zero in the list will "throw back" the accumulated result to zero; this is not considered a serious issue, but another more serious one is that, in the case the list possesses a leading zero, the final result will be invariably zero, because the zero will be the last exponent to be calculated.</p>

<p>Both problems can be eliminated by substituting zeroes for the normalized mean value, with no detectable side effects. This guarantees, also, no stabilization of value between zeroes (that the resulting value will keep constant as long as there are zeroes in the input).</p>

<p>A special case of this condition is that one of an all-zero list: it yields the \(0^0\) exponentiation, halting the algorithm. This is not possible to avoid without identifying such list element-by-element. In this implementation, this is done beforehand, and zero is returned.</p>

<p>Another possible halting condition is pertaining to negative inputs. Of course, exponentiation by a negative number results in a fraction which, used as exponent for the next number in the list, which could be negative, could yield calculation of an even root over a negative number, producing a complex number.</p>

<p>The trivial solution is taken, of taking absolutes of the inputs, as changes of signal will change the mean as well. The mean is used here again as a help.</p>

<p>Another possible manipulation scenario is that of a swap of two values between themselves  which are multiples of ten between themselves. This combines the swapping and magnitude reduction manipulations. This is the second problem we choose to not fix, by hypothesising a low desireability.</p>

<p>Finally, the operation of consecutive exponentiation is susceptible, at least theoretically, to floating point collisions, because of rounding. The probability of such a collision happening is assumed to be low enough for common use cases.</p>

<h3>Summary</h3>

<p>This number should uniquely represent a list of numbers, except for the following manipulations:</p>

<ul>
  <li>Changes of all numbers by factors of 10;</li>
  <li>Swaps of numbers which are multiples of 10 between themselves.</li>
</ul>

<h3>Visualization</h3>

<p>In figures 1-2, the sucessive calculated value can be seen in random number list. The result obtained is the last point of the lines.</p>
<p>In figures 3-4, we see the evolution of final results generated over sequences of lists of mostly equidistant and equidistant numbers, respectively, coming from real and synthetic data (incremental entity ids). These are used to try to show possibilities of collisions in the \(y\)-axis, although there are not necessarily collisions in sections of the lines sharing the same \(y\) intervals.<br/>

<div style="overflow: auto; margin-left: auto; margin-right: auto; width: 39em; margin-bottom: 40px; margin-top: 40px; border: 0px solid black">
  <div style="float: left; margin-right: 2em; border: 0px solid black">
    <img src="img/an_index_for_number_list_identification/a10.png"/>
    <div class="figlabel">Fig. 1: successive calculation over a <br/>random 10-sized list</div>
  </div>
  <div style="float: left; margin-left: 2em; border: 0px solid black">
    <img src="img/an_index_for_number_list_identification/a100.png"/>
    <div class="figlabel">Fig. 2: successive calculation over a <br/>random 100-sized list</div>
  </div>
</div>
<div style="overflow: auto; margin-left: auto; margin-right: auto; width: 39em; border: 0px solid black">
  <div style="float: left; margin-right: 2em; border: 0px solid black">
    <img src="img/an_index_for_number_list_identification/b1.png"/>
    <div class="figlabel">Fig. 3: final results for 1000 lists <br/>of mostly equidistant numbers</div>
  </div>
  <div style="float: left; margin-left: 2em; border: 0px solid black">
    <img src="img/an_index_for_number_list_identification/b2.png"/>
    <div class="figlabel">Fig. 4: final results for 1000 <br/>lists of equidistant numbers</div>
  </div>
</div>

<h3>Benchmarking</h3>

<p>The algorithm execution involves one pass over the entire list, for the result calculation, and two more for the mean and standard deviation calculation. It falls within the category of a linear algorithm.</p>

<p>Platform: Ryzen 5 5600G, 16,00 GB, Windows 10.</p>

<table class="infotbl">
    <tr>
      <th>Random list size</th>
      <td>100.000</td>
      <td>1.000.000</td>
      <td>10.000.000</td>
      <td>100.000.000</td>
      <td>1.000.000.000</td>
    </tr>
    <tr>
      <th>Time</th>
      <td>0.009 s</td>
      <td>0.092 s</td>
      <td>0.921 s</td>
      <td>9.235 s</td>
      <td>93.572 s</td>
    </tr>
</table>

<h3>Implementations</h3>

<ul>
  <li><a href="https://github.com/pedroos/NoperHash" target="_blank">C# (GitHub)</a></li>
</ul>

<a name="references"><h3>References</h3></a>

<ol>
  <li><a href="https://math.stackexchange.com/a/3290588/479728" target="_blank">Structure of integer pairs which commute under exponentiation</a></li>
</ol>
  
</details>
</article>

<!-- End article "An Exponentiation-based Float Hash" -->
<!-- Begin article "Layered Intervals Algorithm" -->

<article>
    <h1>Computing layered intervals</h1>
    
    <!-- <div class="blogtags"><span class="blogtag algo">Algorithms</span><span class="blogtag algo">C#</span></div> -->
  
    <div class="article_details"><p>04/2018</p><hr/></div>
  
    <details>
  
    <summary><blockquote class="special"><b>Abstract: </b>This article introduces a linear algorithm for calculating a final set of intervals with a layered set of intervals as input, addressing the challenge of accounting for obstructions in higher level layers. A pseudocode implementation and an accompanying C# implementation with tests are included.</blockquote></summary>

<p>This page describes an algorithm created to calculate a final set of intervals with a set of layered intervals as input linearly (i.e., from left to right).</p>

<!-- all 640 plus margins (2x unit) wide, 640/20 = 32 unit width -->

<div align="center" class="imgpause">

<svg width="704" height="244">
    <g stroke="#999999" stroke-width="1">
        <line stroke="blue" stroke-width="3" x1="32" y1="32" x2="88" y2="32"/>
        <line x1="88" y1="32" x2="616" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="616" y1="32" x2="672" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="88" y1="64" x2="144" y2="64"/>
        <line x1="144" y1="64" x2="560" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="560" y1="64" x2="616" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="144" y1="96" x2="200" y2="96"/>
        <line x1="200" y1="96" x2="504" y2="96"/>
        <line stroke="blue" stroke-width="3" x1="504" y1="96" x2="560" y2="96"/>
        <line stroke="blue" stroke-width="3" x1="200" y1="128" x2="256" y2="128"/>
        <line x1="256" y1="128" x2="448" y2="128"/>
        <line stroke="blue" stroke-width="3" x1="448" y1="128" x2="504" y2="128"/>
        <line stroke="blue" stroke-width="3" x1="256" y1="160" x2="312" y2="160"/>
        <line x1="312" y1="160" x2="392" y2="160"/>
        <line stroke="blue" stroke-width="3" x1="392" y1="160" x2="448" y2="160"/>
        <line stroke="blue" stroke-width="3" x1="312" y1="192" x2="392" y2="192"/>
        <line stroke="darkred" stroke-width="1" x1="32" y1="224" x2="672" y2="224"/>
        <!-- verticals -->
        <g stroke="#000000" stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="234"/>
            <line x1="88" y1="64" x2="88" y2="234"/>
            <line x1="144" y1="96" x2="144" y2="234"/>
            <line x1="200" y1="128" x2="200" y2="234"/>
            <line x1="256" y1="160" x2="256" y2="234"/>
            <line x1="312" y1="192" x2="312" y2="234"/>
            <line x1="392" y1="192" x2="392" y2="234"/>
            <line x1="448" y1="160" x2="448" y2="234"/>
            <line x1="504" y1="128" x2="504" y2="234"/>
            <line x1="560" y1="96" x2="560" y2="234"/>
            <line x1="616" y1="64" x2="616" y2="234"/>
            <line x1="672" y1="32" x2="672" y2="234"/>
        </g>
    </g>
</svg><br/>

<svg width="704" height="244">
    <g stroke="#999999" stroke-width="1">
        <line x1="32" y1="32" x2="672" y2="32"/>
        <line x1="88" y1="64" x2="616" y2="64"/>
        <line x1="144" y1="96" x2="560" y2="96"/>
        <line x1="200" y1="128" x2="504" y2="128"/>
        <line x1="256" y1="160" x2="448" y2="160"/>
        <line x1="312" y1="192" x2="392" y2="192"/>
        <line x1="32" y1="224" x2="672" y2="224"/>
        <!-- verticals -->
        <g stroke="#999999" stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="234"/>
            <line x1="88" y1="64" x2="88" y2="234"/>
            <line x1="144" y1="96" x2="144" y2="234"/>
            <line x1="200" y1="128" x2="200" y2="234"/>
            <line x1="256" y1="160" x2="256" y2="234"/>
            <line x1="312" y1="192" x2="312" y2="234"/>
            <line x1="392" y1="192" x2="392" y2="234"/>
            <line x1="448" y1="160" x2="448" y2="234"/>
            <line x1="504" y1="128" x2="504" y2="234"/>
            <line x1="560" y1="96" x2="560" y2="234"/>
            <line x1="616" y1="64" x2="616" y2="234"/>
            <line x1="672" y1="32" x2="672" y2="234"/>
        </g>
        <!-- path -->
        <g stroke="#dddd55" stroke-width="1">
            <line x1="32" y1="32" x2="88" y2="64"/>
            <line x1="88" y1="64" x2="144" y2="96"/>
            <line x1="144" y1="96" x2="200" y2="128"/>
            <line x1="200" y1="128" x2="256" y2="160"/>
            <line x1="256" y1="160" x2="312" y2="192"/>
            <line x1="312" y1="192" x2="392" y2="192"/>
            <line x1="392" y1="192" x2="448" y2="160"/>
            <line x1="448" y1="160" x2="504" y2="128"/>
            <line x1="504" y1="128" x2="560" y2="96"/>
            <line x1="560" y1="96" x2="616" y2="64"/>
            <line x1="616" y1="64" x2="672" y2="32"/>
        </g>
    </g>
</svg><br/><br/>

<svg width="704" height="116">
    <g stroke="#999999" stroke-width="1">
        <line stroke="blue" stroke-width="3" x1="32" y1="32" x2="64" y2="32"/>
        <line x1="64" y1="32" x2="128" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="64" y1="64" x2="128" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="128" y1="32" x2="192" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="192" y1="64" x2="256" y2="64"/>
        <line x1="320" y1="32" x2="384" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="384" y1="32" x2="448" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="320" y1="64" x2="384" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="512" y1="32" x2="576" y2="32"/>
        <line x1="576" y1="32" x2="640" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="640" y1="32" x2="672" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="576" y1="64" x2="640" y2="64"/>
        <line stroke="darkred" stroke-width="1" x1="32" y1="96" x2="256" y2="96"/>
        <line stroke="darkred" stroke-width="1" x1="320" y1="96" x2="448" y2="96"/>
        <line stroke="darkred" stroke-width="1" x1="512" y1="96" x2="672" y2="96"/>
        <!-- verticals -->
        <g stroke="#000000" stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="106"/>
            <line x1="64" y1="64" x2="64" y2="106"/>
            <line x1="128" y1="64" x2="128" y2="106"/>
            <line x1="192" y1="64" x2="192" y2="106"/>
            <line x1="256" y1="64" x2="256" y2="106"/>
            <line x1="320" y1="64" x2="320" y2="106"/>
            <line x1="384" y1="64" x2="384" y2="106"/>
            <line x1="448" y1="32" x2="448" y2="106"/>
            <line x1="512" y1="32" x2="512" y2="106"/>
            <line x1="576" y1="64" x2="576" y2="106"/>
            <line x1="640" y1="64" x2="640" y2="106"/>
            <line x1="672" y1="32" x2="672" y2="106"/>
        </g>
    </g>
</svg><br/>

<svg width="704" height="116">
    <g stroke="#999999" stroke-width="1">
        <line x1="32" y1="32" x2="192" y2="32"/>
        <line x1="320" y1="32" x2="448" y2="32"/>
        <line x1="512" y1="32" x2="672" y2="32"/>
        <line x1="64" y1="64" x2="128" y2="64"/>
        <line x1="192" y1="64" x2="256" y2="64"/>
        <line x1="320" y1="64" x2="384" y2="64"/>
        <line x1="576" y1="64" x2="640" y2="64"/>
        <line x1="32" y1="96" x2="256" y2="96"/>
        <line x1="320" y1="96" x2="448" y2="96"/>
        <line x1="512" y1="96" x2="672" y2="96"/>
        <!-- verticals -->
        <g stroke="#999999" stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="106"/>
            <line x1="64" y1="64" x2="64" y2="106"/>
            <line x1="128" y1="64" x2="128" y2="106"/>
            <line x1="192" y1="64" x2="192" y2="106"/>
            <line x1="256" y1="64" x2="256" y2="106"/>
            <line x1="320" y1="64" x2="320" y2="106"/>
            <line x1="384" y1="64" x2="384" y2="106"/>
            <line x1="448" y1="32" x2="448" y2="106"/>
            <line x1="512" y1="32" x2="512" y2="106"/>
            <line x1="576" y1="64" x2="576" y2="106"/>
            <line x1="640" y1="64" x2="640" y2="106"/>
            <line x1="672" y1="32" x2="672" y2="106"/>
        </g>
        <!-- path -->
        <g stroke="#dddd55" stroke-width="1">
            <line x1="32" y1="32" x2="64" y2="64"/>
            <line x1="64" y1="64" x2="128" y2="64"/>
            <line x1="128" y1="64" x2="192" y2="64"/>
            <line x1="192" y1="64" x2="256" y2="64"/>
            <line x1="256" y1="64" x2="320" y2="64"/>
            <line x1="320" y1="64" x2="384" y2="64"/>
            <line x1="384" y1="64" x2="448" y2="32"/>
            <line x1="448" y1="32" x2="512" y2="32"/>
            <line x1="512" y1="32" x2="576" y2="64"/>
            <line x1="576" y1="64" x2="640" y2="64"/>
            <line x1="640" y1="64" x2="672" y2="32"/>
        </g>
    </g>
</svg><br/><br/>

<svg width="704" height="222" style="display: none;">
    <g stroke="#000000" stroke-width="1">
        <line x1="32" y1="32" x2="160" y2="32"/>
        <line x1="288" y1="32" x2="416" y2="32"/>
        <line x1="480" y1="32" x2="672" y2="32"/>
        <line x1="96" y1="64" x2="224" y2="64"/>
        <line x1="384" y1="64" x2="448" y2="64"/>
        <line x1="544" y1="64" x2="672" y2="64"/>
        <line x1="192" y1="96" x2="416" y2="96"/>
        <line x1="512" y1="96" x2="640" y2="96"/>
        <line x1="352" y1="128" x2="416" y2="128"/>
        <line x1="576" y1="128" x2="608" y2="128"/>
        <line x1="448" y1="160" x2="576" y2="160"/>
        <line x1="32" y1="192" x2="672" y2="192"/>
        <!-- verticals -->
        <g stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="202"/>
            <line x1="96" y1="64" x2="96" y2="202"/>
            <line x1="160" y1="32" x2="160" y2="64"/>
            <line x1="192" y1="96" x2="192" y2="202"/>
            <line x1="224" y1="64" x2="224" y2="96"/>
            <line x1="288" y1="96" x2="288" y2="32"/>
            <line x1="352" y1="128" x2="352" y2="202"/>
            <line x1="384" y1="64" x2="384" y2="96"/>
            <line x1="416" y1="32" x2="416" y2="64"/>
            <line x1="416" y1="96" x2="416" y2="202"/>
            <line x1="448" y1="64" x2="448" y2="202"/>
            <line x1="480" y1="32" x2="480" y2="160"/>
            <line x1="512" y1="96" x2="512" y2="160"/>
            <line x1="544" y1="64" x2="544" y2="96"/>
            <line x1="576" y1="128" x2="576" y2="202"/>
            <line x1="608" y1="128" x2="608" y2="202"/>
            <line x1="640" y1="96" x2="640" y2="202"/>
            <line x1="672" y1="32" x2="672" y2="202"/>
        </g>
        <!-- path -->
        <!--<g stroke="#0000ff" stroke-width="1">
            <line x1="32" y1="32" x2="96" y2="64"/>
            <line x1="96" y1="64" x2="192" y2="96"/>
            <line x1="192" y1="96" x2="352" y2="128"/>
            <line x1="352" y1="128" x2="414" y2="128"/>
            <line x1="414" y1="128" x2="446" y2="160"/>
            <line x1="446" y1="160" x2="574" y2="160"/>
            <line x1="574" y1="160" x2="606" y2="128"/>
            <line x1="606" y1="128" x2="638" y2="96"/>
            <line x1="638" y1="96" x2="670" y2="64"/>
        </g>-->
    </g>
</svg><br/>

<svg width="704" height="276">
    <g stroke="#000000" stroke-width="1">
        <line stroke="blue" stroke-width="3" x1="32" y1="32" x2="96" y2="32"/>
        <line x1="96" y1="32" x2="160" y2="32"/>
        <line x1="96" y1="64" x2="224" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="96" y1="96" x2="224" y2="96"/>
        <line x1="224" y1="96" x2="288" y2="96"/>
        <line stroke="blue" stroke-width="3" x1="224" y1="128" x2="260" y2="128"/>
        <line x1="260" y1="128" x2="288" y2="128"/>
        <line x1="224" y1="32" x2="352" y2="32"/>
        <line stroke="blue" stroke-width="3" x1="256" y1="160" x2="288" y2="160"/>
        <line x1="288" y1="160" x2="320" y2="160"/>
        <line x1="288" y1="192" x2="320" y2="192"/>
        <line stroke="blue" stroke-width="3" x1="320" y1="192" x2="386" y2="192"/>
        <line x1="386" y1="192" x2="416" y2="192"/>
        <line stroke="blue" stroke-width="3" x1="288" y1="224" x2="320" y2="224"/>
        <line x1="288" y1="64" x2="416" y2="64"/>
        <line x1="320" y1="128" x2="384" y2="128"/>
        <line stroke="blue" stroke-width="3" x1="384" y1="224" x2="416" y2="224"/>
        <line x1="384" y1="160" x2="416" y2="160"/>
        <line stroke="blue" stroke-width="3" x1="416" y1="160" x2="448" y2="160"/>
        <line x1="416" y1="128" x2="448" y2="128"/>
        <line stroke="blue" stroke-width="3" x1="448" y1="128" x2="480" y2="128"/>
        <line x1="416" y1="96" x2="480" y2="96"/>
        <line stroke="blue" stroke-width="3" x1="480" y1="96" x2="544" y2="96"/>
        <line x1="416" y1="32" x2="544" y2="32"/>
        <line x1="480" y1="64" x2="544" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="544" y1="64" x2="608" y2="64"/>
        <line stroke="blue" stroke-width="3" x1="608" y1="32" x2="672" y2="32"/>
        <line x1="32" stroke="darkred" y1="256" x2="672" y2="256"/>
        <!-- verticals -->
        <g stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="266"/>
            <line x1="96" y1="64" x2="96" y2="266"/>
            <line x1="160" y1="32" x2="160" y2="64"/>
            <line x1="224" y1="128" x2="224" y2="266"/>
            <line x1="224" y1="32" x2="224" y2="96"/>
            <line x1="256" y1="160" x2="256" y2="266"/>
            <line x1="288" y1="192" x2="288" y2="266"/>
            <line x1="288" y1="64" x2="288" y2="160"/>
            <line x1="320" y1="224" x2="320" y2="266"/>
            <line x1="320" y1="128" x2="320" y2="192"/>
            <line x1="352" y1="32" x2="352" y2="64"/>
            <line x1="384" y1="224" x2="384" y2="266"/>
            <line x1="384" y1="128" x2="384" y2="192"/>
            <line x1="416" y1="192" x2="416" y2="266"/>
            <line x1="416" y1="32" x2="416" y2="160"/>
            <line x1="448" y1="160" x2="448" y2="266"/>
            <line x1="480" y1="128" x2="480" y2="266"/>
            <line x1="480" y1="64" x2="480" y2="96"/>
            <line x1="544" y1="96" x2="544" y2="266"/>
            <line x1="544" y1="32" x2="544" y2="64"/>
            <line x1="608" y1="32" x2="608" y2="266"/>
            <line x1="672" y1="32" x2="672" y2="266"/>
        </g>
        <!-- path -->
        <g stroke="#0000ff" stroke-width="1">
            <!--<line x1="32" y1="32" x2="64" y2="64"/>-->
        </g>
        <!-- numbers -->
        <!--<text x="63" y="276">1</text>
        <text x="157" y="276">2</text>
        <text x="238" y="276">3</text>
        <text x="269" y="276">4</text>
        <text x="300" y="276">5</text>
        <text x="348" y="276">6</text>
        <text x="396" y="276">7</text>
        <text x="429" y="276">8</text>
        <text x="459" y="276">9</text>
        <text x="504" y="276">10</text>
        <text x="569" y="276">11</text>
        <text x="632" y="276">12</text>-->
    </g>
</svg><br/>

<svg width="704" height="286">
    <g stroke="#999999" stroke-width="1">
        <line x1="32" y1="32" x2="160" y2="32"/>
        <line x1="96" y1="64" x2="224" y2="64"/>
        <line x1="96" y1="96" x2="288" y2="96"/>
        <line x1="224" y1="128" x2="288" y2="128"/>
        <line x1="224" y1="32" x2="352" y2="32"/>
        <line x1="256" y1="160" x2="320" y2="160"/>
        <line x1="288" y1="192" x2="416" y2="192"/>
        <line x1="288" y1="224" x2="320" y2="224"/>
        <line x1="288" y1="64" x2="416" y2="64"/>
        <line x1="320" y1="128" x2="384" y2="128"/>
        <line x1="384" y1="224" x2="416" y2="224"/>
        <line x1="384" y1="160" x2="448" y2="160"/>
        <line x1="416" y1="128" x2="480" y2="128"/>
        <line x1="416" y1="96" x2="544" y2="96"/>
        <line x1="416" y1="32" x2="544" y2="32"/>
        <line x1="480" y1="64" x2="608" y2="64"/>
        <line x1="608" y1="32" x2="672" y2="32"/>
        <line x1="32" y1="256" x2="672" y2="256"/>
        <!-- verticals -->
        <g stroke-dasharray="6, 6">
            <line x1="32" y1="32" x2="32" y2="266"/>
            <line x1="96" y1="64" x2="96" y2="266"/>
            <line x1="160" y1="32" x2="160" y2="64"/>
            <line x1="224" y1="128" x2="224" y2="266"/>
            <line x1="224" y1="32" x2="224" y2="96"/>
            <line x1="256" y1="160" x2="256" y2="266"/>
            <line x1="288" y1="192" x2="288" y2="266"/>
            <line x1="288" y1="64" x2="288" y2="160"/>
            <line x1="320" y1="224" x2="320" y2="266"/>
            <line x1="320" y1="128" x2="320" y2="192"/>
            <line x1="352" y1="32" x2="352" y2="64"/>
            <line x1="384" y1="224" x2="384" y2="266"/>
            <line x1="384" y1="128" x2="384" y2="192"/>
            <line x1="416" y1="192" x2="416" y2="266"/>
            <line x1="416" y1="32" x2="416" y2="160"/>
            <line x1="448" y1="160" x2="448" y2="266"/>
            <line x1="480" y1="128" x2="480" y2="266"/>
            <line x1="480" y1="64" x2="480" y2="96"/>
            <line x1="544" y1="96" x2="544" y2="266"/>
            <line x1="544" y1="32" x2="544" y2="64"/>
            <line x1="608" y1="32" x2="608" y2="266"/>
            <line x1="672" y1="32" x2="672" y2="266"/>
        </g>
        <!-- path -->
        <g stroke="#dddd55" stroke-width="1">
            <line x1="32" y1="32" x2="96" y2="96"/>
            <line x1="96" y1="96" x2="224" y2="128"/>
            <line x1="224" y1="128" x2="256" y2="160"/>
            <line x1="256" y1="160" x2="288" y2="224"/>
            <line x1="288" y1="224" x2="320" y2="224"/>
            <line x1="320" y1="224" x2="384" y2="224"/>
            <line x1="384" y1="224" x2="416" y2="224"/>
            <line x1="416" y1="224" x2="448" y2="160"/>
            <line x1="448" y1="160" x2="480" y2="128"/>
            <line x1="480" y1="128" x2="544" y2="96"/>
            <line x1="544" y1="96" x2="608" y2="64"/>
            <line x1="608" y1="64" x2="672" y2="32"/>
        </g>
    </g>
</svg>

</div>

<p>The above images are examples of composed intervals (the lines are the paths taken by the algorithm).</p>

<p>As you can see, the main obstacle in calculating such composed intervals is accounting for obstructions in more important (i.e., higher priority) layers.</p>

<p>This is the simplest method to perform this computation in a linear way I could come up with.</p>

<p>For a tree approach, see [<a href="#references">1</a>].</p>

<h3>Pseudocode</h3>

<pre>
    from first to last node, ordered by position first and ascending lane second:
    if not closing:
        if not open in any higher lane:
            if final opened:
                close final.
            open final.
        open in this lane.
    if closing:
        closed in this lane.
        if final opened:
            if not open in any higher lane:
                close final.
    if not final opened:
        if at last lane of position, except for the last position:
            if open in any other lane:
                open final.
</pre>

<!--<h3>Occlusion check</h3>

<p>Upon modifications, only any non-occluded sections of the changed interval are considered by re-calculation. If the points in the end line would not be affected (because the entire change is occluded), no re-calculation is performed in this case.</p>-->

<h3>Implementations</h3>

<p>With tests.</p>

<ul>
    <li><a href="https://github.com/pedroos/IntervalComposition" target="_blank">C#</a></li>
</ul>

<a name="references"><h3>References</h3></a>

<ol>
    <li><a href="https://en.wikipedia.org/wiki/Interval_tree" target="_blank">Interval tree (Wikipedia)</a></li>
</ol>
  
</details>
</article>

<!-- End article "Layered Intervals Algorithm" -->
<!-- Begin article "Lattice Big Integer Multiplication" -->

<article>
    <h1>Lattice big-integer multiplication</h1>
    
    <!-- <div class="blogtags"><span class="blogtag algo">Algorithms</span><span class="blogtag algo">C#</span></div> -->
  
    <div class="article_details"><p>01/2018</p><hr/></div>
  
    <details>
  
    <summary><blockquote class="special"><b>Abstract: </b>This article presents an implementation of the lattice multiplication method, an ancient technique for multiplying large numbers, in C#. The basic idea is that numbers can be multiplied digit-by-digit and, as each digit only ranges from 0 to 9, the maximum multiplication performed per step is 9 x 9. The implementation, capable of computing 4999! (with 16322 digits) in around one minute, uses a cell-walking routine to traverse arbitrary shape lattices in three distinct phases. The article also includes pseudocode implementations and references.</blockquote></summary>

<p>As we know, not very large numbers (such as 99) have very large factorials, with this one having 156 decimal places.</p>

<p>The problem with multiplying those numbers is the common problem of overflow with large number computations.</p>

<p>For example, 29! fails to compute with ulongs in C#, producing 11390785281054474240 instead of 8841761993739701954543616000000.</p>

<p>The lattice or gelosia method here implemented is an ancient multiplication method with the idea that numbers can be multiplied digit-by-digit and, as each digit only ranges from 0 to 9, the maximum multiplication performed per step is 9 x 9.</p>

<p>The method is executed by laying out first the digits of the multiplicands across the borders of a table. The multiplied digits are read in diagonal lines and summed, and these summed digits become the result of the multiplication.</p>

<noscript>
<img src="img/lattice_algorithm_for_big_integer_multiplication_1.png" />
</noscript>

<div class="imgpause" style="width: 750px; margin-left: auto; margin-right: auto;">

<div style="float: left; text-align: center;">
    <canvas id="lattice_one" width="300" height="200" style="border: 0px solid black"></canvas>
</div>
<div style="float: left; text-align: center;">
    <canvas id="lattice_two" width="200" height="300" style="border: 0px solid black"></canvas>
</div>
<div style="float: left; text-align: center;">
    <canvas id="lattice_three" width="250" height="250" style="border: 0px solid black"></canvas>
</div>

</div>

<br style="clear: left;"/>

<p>I penned a particular implementation of the calculation of the lattice method after inspiration through [<a href="#references">1</a>]. (The cell walking routine is also implemented in the above graphic in JavaScript.)</p>

<p>This particular implementation can compute 4999! (which has 16322 digits) in 1m24s. It works by walking cells of arbitrary shape (width x height) lattices (the grids shown above).</p>

<p>The basic procedure can be divided in the following kinds of steps:</p>

<p>1) Basic cell-to-cell walk</p>

<p>2) Line changes</p>

<p>3) Phase changes (including the end of the walk)</p>

<p>There are three phases.</p>

<p>In any phase, the basic cell walk routine is the same: if we are in an odd cell (the "uppermost" triangle in a square), we go to the left square to the even cell. Furthermore, if we are in an even cell (the "lowermost" triangle in the square), we go down one square and switch to the odd cell.</p>

<p>If we reach the lower cells in the first phase, in any shape lattices, or in the second phase in horizontal lattices, a line change occurs. If we reach the leftmost cells in the third phase of any shape lattice or in the second phase of vertical lattices, a line change also occurs.
    
<p>The first and third phases are common to all shape lattices, and the second phase (only occurring in non-square lattices) is of different line-changing procedure with different orientation lattices.</p>

<p>In any phase, when changing lines, we look for when the phase changes. According to the orientation, the phase transition can jump an additional line, before changing phases, or not.</p>

<h3>Pseudocode</h3>

<pre>
    let d1 be the amount of digits in the multiplicator, and 
    d2 be the amount of digits in the multiplicand.

    do:
        multiply the digits at x and y.
        add to the sum.
        orientation undefined.

        if end of line of any phase:
            if carrying digit, add it to sum.
            if one digit sum:
                take the only digit.
            if two digits sum:
                take the second digit and carry the first.
            result position less one.
            reset the sum.
        
        if end of line of phase 1:
            if x is at d1 + 1 - d2 (the "square" position):
                the lattice is horizontal.
            if x is at 1:
                the lattice is vertical.
            if the lattice is both horizontal and vertical:
                the lattice is square.

            if orientation is defined and:
                it's square:
                    phase is 3.
                    jump cell like the new phase, but 
                    x is 1 and odd toggles to true.
                it's horizontal:
                    phase is 2.
                    jump cell like the new phase.
                it's vertical:
                    phase is 2.
                    jump cell normally.
            if not:
                jump cell normally.
        if end of line phase 2 vertical:
            if y is d1 + 1:
                phase is 3.
                jump cell like the new phase.
            if not:
                jump cell normally.
        if end of line phase 2 horizontal:
            if x is 1:
                phase is 3.
            jump cell normally.
        if end of line phase 3:
            if y is 1:
                end of walk.
            if not:
                jump cell normally.
        if no end of line:
            if not odd:
                y is increased 1.
            if odd:
                x is decreased 1.
            toggle odd.
</pre>

<a name="implementations"><h3>Implementations</h3></a>

<p>With tests.</p>

<ul>
    <li><a href="https://github.com/pedroos/Lattice1" target="_blank">C#</a></li>
</ul>

<a name="references"><h3>References</h3></a>

<ol>
    <li><a href="https://stackoverflow.com/a/2120888/38234" target="_blank">Homework: how to write own multiplication of big numbers?, Stack Overflow</a></li>
</ol>
  
</details>
</article>

<script>
    var INITIAL_BLINK_POS = 0;

    var playing = true;
    var stopResume = function() {
        if (playing) {
            latFun.stop();
            document.getElementById("stopResumeButton").innerText = "Resume";
        }
        else {
            latFun.resume();
            document.getElementById("stopResumeButton").innerText = "Stop";
        }
        playing = !playing;
    };

    var latFun = (function() {
        var drawLattice = function(lat) {
            var canvas = document.getElementById("lattice_"+lat.el);
            if (canvas == null) return;
            var ctx = canvas.getContext("2d");
            var margin = 25;
            // clear
            ctx.rect(0, 0, margin+(lat.d1*50)+margin, margin+(lat.d2*50)+margin);
            ctx.fillStyle = "#ffffff";
            ctx.fill();
            // draw
            ctx.lineWidth = 1;
            ctx.strokeStyle = "#000000";
            for (var i = 0; i <= lat.d1; i++) {
                ctx.beginPath();
                ctx.moveTo(margin+(i * 50), margin);
                ctx.lineTo(margin+(i * 50), margin+(lat.d2 * 50));
                ctx.stroke();
            }
            ctx.lineWidth = 1;
            for (var i = 0; i <= lat.d2; i++) {
                ctx.beginPath();
                ctx.moveTo(margin, margin+(i * 50));
                ctx.lineTo(margin+(lat.d1 * 50), margin+(i * 50));
                ctx.stroke();
            }
            ctx.lineWidth = 1;
            for (var i = 0; i < lat.d1; i++) {
                for (var j = 0; j < lat.d2; j++) {
                    ctx.beginPath();
                    //if (((i+1)*(j+1))+(i+1)-1%lat.d1 == 0) ctx.lineWidth = 3;
                    ctx.moveTo(margin+(i * 50), margin+((j+1) * 50));
                    ctx.lineTo(margin+((i+1) * 50), margin+(j * 50));
                    ctx.stroke();
                }
            }
        };

        var lightCell = function(lat, x, y, odd) {
            var canvas = document.getElementById("lattice_"+lat.el);
            if (canvas == null) return;
            var ctx = canvas.getContext("2d");
            var margin = 25;
            ctx.lineWidth = 3;
            ctx.strokeStyle = lat.walk.phase == 1 ? "#ff0000" : 
                lat.walk.phase == 2 ? "#00ff00" : 
                "#0000ff";
            ctx.beginPath();
            ctx.moveTo(margin+((x-1)*50), margin+(y*50));
            ctx.lineTo(margin+(x*50), margin+((y-1)*50));
            ctx.moveTo(margin+(x*50), margin+((y-1)*50));
            if (odd) {
                ctx.lineTo(margin+((x-1)*50), margin+((y-1)*50));
                ctx.moveTo(margin+((x-1)*50), margin+((y-1)*50));
                ctx.lineTo(margin+((x-1)*50), margin+(y*50));
            }
            else {
                ctx.lineTo(margin+(x*50), margin+(y*50));
                ctx.moveTo(margin+(x*50), margin+(y*50));
                ctx.lineTo(margin+((x-1)*50), margin+(y*50));
            }
            ctx.stroke();
        };

        var latticeOrientation = {
            none: 0, 
            horizontal: 1, 
            vertical: 2
        };

        var lattices = [
        {
            el: "one", 
            d1: 5, 
            d2: 3, 
            walk: {
                x: 5, 
                y: 3, 
                odd: false, 
                phase: 1, 
                orientation: latticeOrientation.none
            }
        }, 
        {
            el: "two", 
            d1: 3, 
            d2: 5, 
            walk: {
                x: 3, 
                y: 5, 
                odd: false, 
                phase: 1, 
                orientation: latticeOrientation.none
            }
        }, 
        {
            el: "three", 
            d1: 4, 
            d2: 4, 
            walk: {
                x: 4, 
                y: 4, 
                odd: false, 
                phase: 1, 
                orientation: latticeOrientation.none
            }
        }
        ];

        for (var i = 0; i < lattices.length; i ++) {
            drawLattice(lattices[i]);
            lattices[i].blink = {
                state: true
            };
        }

        var blinkPos = INITIAL_BLINK_POS;
        var blinkFrequency = 500;

        var blink = function(lat) {
            if (lat.blink.state) {
                lightCell(lat, lat.walk.x, lat.walk.y, lat.walk.odd);
                //lat.blink.state = !lat.blink.state;
            }
            else {
                drawLattice(lat);

                // check line ends
                var lineEndPhase1 = lat.walk.phase == 1 && lat.walk.y == lat.d2 && !lat.walk.odd;
                var lineEndPhase2V = lat.walk.phase == 2 && lat.walk.orientation == latticeOrientation.vertical && lat.walk.x == 1 && lat.walk.odd;
                var lineEndPhase2H = lat.walk.phase == 2 && lat.walk.orientation == latticeOrientation.horizontal && lat.walk.y == lat.d2 && !lat.walk.odd;
                var lineEndPhase3 = lat.walk.phase == 3 && lat.walk.x == 1 && lat.walk.odd;

                if (lineEndPhase1)
                {
                    // check phase change
                    if (lat.walk.x == lat.d1 + 1 - lat.d2)
                    {
                        lat.walk.orientation = lat.walk.orientation + latticeOrientation.horizontal;
                    }
                    if (lat.walk.x == 1)
                    {
                        lat.walk.orientation = lat.walk.orientation + latticeOrientation.vertical;
                    }

                    // phase changing
                    if (lat.walk.orientation != latticeOrientation.none)
                    {
                        if (lat.walk.orientation == latticeOrientation.horizontal + latticeOrientation.vertical)
                        {
                            lat.walk.phase = 3;
                            // use the new phase jump, but:
                            lat.walk.x = lat.walk.y; // x += 1
                            lat.walk.y = 1;
                            lat.walk.odd = !lat.walk.odd; // and odd toggles to true
                        }
                        else
                        {
                            lat.walk.phase = 2;
                            if (lat.walk.orientation == latticeOrientation.horizontal)
                            {
                                // use the new phase jump
                                lat.walk.y = 1;
                                lat.walk.x += lat.d2 - 1;
                                lat.walk.odd = !lat.walk.odd; // odd toggles to true
                            }
                            else if (lat.walk.orientation == latticeOrientation.vertical)
                            {
                                // don't use the new phase jump, use this phase's jump
                                lat.walk.y -= lat.d1 + 1 - lat.walk.x;
                                lat.walk.x = lat.d1;
                                // odd stays false
                            }
                        }
                    }
                    else
                    {
                        lat.walk.y -= lat.d1 + 1 - lat.walk.x;
                        lat.walk.x = lat.d1;
                        // odd stays false
                    }
                }
                else if (lineEndPhase2V)
                {
                    // check phase change
                    if (lat.walk.y == lat.d1 + 1)
                    {
                        lat.walk.phase = 3;
                        // use the new phase jump
                        lat.walk.x = lat.walk.y - 1;
                        lat.walk.y = 1;
                    }
                    else
                    {
                        lat.walk.x = lat.d1;
                        lat.walk.y -= lat.d1 + 1;
                        lat.walk.odd = !lat.walk.odd; // odd toggles to false
                    }
                }
                else if (lineEndPhase2H)
                {
                    // check phase change
                    if (lat.walk.x == 1)
                    {
                        lat.walk.phase = 3;
                        // don't use the new phase jump, use this phase's jump
                        lat.walk.y = 1;
                        lat.walk.x += lat.d2 - 1;
                        lat.walk.odd = !lat.walk.odd; // odd toggles to true
                    }
                    else
                    {
                        lat.walk.y = 1;
                        lat.walk.x += lat.d2 - 1;
                        lat.walk.odd = !lat.walk.odd; // odd toggles to true
                    }
                }
                else if (lineEndPhase3)
                {
                    // check end
                    if (lat.walk.y == 1)
                    {
                        // walk end
                        lat.walk.y = lat.d2;
                        lat.walk.x = lat.d1;
                        lat.walk.odd = false;
                        lat.walk.phase = 1;
                        lat.walk.orientation = latticeOrientation.none;

                        clearInterval(lat.blink.interval);
                        lat.blink.interval = -1;
                        blinkPos ++;
                        if (blinkPos + 1 > lattices.length) blinkPos = INITIAL_BLINK_POS;
                        lattices[blinkPos].blink.interval = setInterval(function() {blink(lattices[blinkPos]);}, blinkFrequency);
                    }
                    else
                    {
                        lat.walk.x = lat.walk.y - 1;
                        lat.walk.y = 1;
                        // odd stays true
                    }
                }
                else
                {
                    // no end of line
                    if (!lat.walk.odd)
                    {
                        lat.walk.y += 1;
                    }
                    else
                    {
                        lat.walk.x -= 1;
                    }
                    lat.walk.odd = !lat.walk.odd;
                }
            }
            lat.blink.state = !lat.blink.state;
        };
        lattices[INITIAL_BLINK_POS].blink.interval = setInterval(function() {blink(lattices[blinkPos]);}, blinkFrequency);

        return {
            stop: function() {
                clearInterval(lattices[blinkPos].blink.interval);
                lattices[blinkPos].blink.interval = -1;
                drawLattice(lattices[blinkPos]);
            }, 
            resume: function() {
                lattices[blinkPos].blink.interval = setInterval(function() {blink(lattices[blinkPos]);}, blinkFrequency);
            }
        };
    })();
</script>

<!-- End article "Lattice Big Integer Multiplication" -->

  </div>

</div>

<footer>
&copy 2018-2024 Pedro Sobota. All rights reserved.
</footer>

</body>
</html>
